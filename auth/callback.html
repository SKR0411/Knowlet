<!DOCTYPE html>
<html>
<head>
    <title>Supabase OAuth Callback</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h2 id="title">Processing login…</h2>
    <pre id="msg"></pre>

    <script>
        // Supabase config
        const SUPABASE_URL = "https://ampwczxrfpbqlkuawrdf.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFtcHdjenhyZnBicWxrdWF3cmRmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3OTk4MzYsImV4cCI6MjA3ODM3NTgzNn0.hFib9Y5x02b5VWjKuNi1XkUYvycmrp0DQhnwNkOGJEU";

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        const title = document.getElementById("title");
        const msg = document.getElementById("msg");

        async function handleCallback() {
            try {
                console.log("Hash:", window.location.hash);
        
                const result = await supabase.auth.getSessionFromUrl({ storeSession: true });
                console.log("Supabase result:", result);
        
                spinner.style.display = "none";
        
                title.textContent = "Done";
                msg.textContent = JSON.stringify(result, null, 2);
        
            } catch (err) {
                spinner.style.display = "none";
                title.textContent = "Unexpected Error ❌";
        
                msg.textContent = err?.message || String(err);
                console.error("REAL ERROR:", err);
            }
        }

        handleCallback();
    </script>
</body>
</html>