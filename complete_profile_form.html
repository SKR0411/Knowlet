<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Complete Your Student Profile</title>
    <style>
        :root{
            --bg:#f6f8fb;
            --card:#ffffff;
            --accent:#0b74de;
            --muted:#6b7280;
            --error:#d9534f;
            --success:#28a745;
            --radius:10px;
            --max-width:900px;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        }

        *{box-sizing:border-box}
        body{
            margin:0;
            background:linear-gradient(180deg, var(--bg), #eef3fb 80%);
            color:#0f1724;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            padding:28px 16px;
            display:flex;
            justify-content:center;
        }

        .container{
            width:100%;
            max-width:var(--max-width);
        }

        .card{
            background:var(--card);
            border-radius:var(--radius);
            box-shadow:0 8px 30px rgba(12,20,40,0.06);
            padding:24px;
            margin-bottom:18px;
        }

        h1{
            margin:0 0 6px 0;
            font-size:20px;
        }
        p.lead{
            margin:0 0 18px 0;
            color:var(--muted);
            font-size:14px;
        }

        form{
            display:grid;
            gap:14px;
        }

        .grid-2{
            display:grid;
            grid-template-columns:1fr 1fr;
            gap:12px;
        }

        .field{
            display:flex;
            flex-direction:column;
        }

        label{
            font-size:13px;
            margin-bottom:6px;
            color:#111827;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        input[type="number"],
        select,
        textarea{
            padding:10px 12px;
            border-radius:8px;
            border:1px solid #e6e9ef;
            background:#fff;
            font-size:14px;
            outline:none;
        }
        textarea{min-height:100px; resize:vertical; padding-top:12px}

        .hint{font-size:12px;color:var(--muted);margin-top:6px}

        .row{
            display:flex;
            gap:10px;
            align-items:center;
            flex-wrap:wrap;
        }

        .photo-drop{
            border:2px dashed #e2e8f0;
            border-radius:8px;
            padding:10px;
            display:flex;
            gap:12px;
            align-items:center;
        }

        .photo-preview{
            width:92px;
            height:92px;
            border-radius:8px;
            background:#f3f6fa;
            display:flex;
            align-items:center;
            justify-content:center;
            overflow:hidden;
            border:1px solid #e9eef6;
        }
        .photo-preview img{width:100%;height:100%;object-fit:cover}

        .btn{
            background:var(--accent);
            color:white;
            border:none;
            padding:10px 16px;
            border-radius:8px;
            cursor:pointer;
            font-weight:600;
            font-size:14px;
        }
        .btn-muted{
            background:transparent;
            border:1px solid #e6e9ef;
            color:#111827;
        }

        .actions{
            display:flex;
            gap:10px;
            justify-content:flex-end;
            margin-top:6px;
        }

        .section-title{
            margin:4px 0 6px 0;
            font-size:14px;
            color:#0f1724;
            font-weight:600;
        }

        .small{
            font-size:13px;
            color:var(--muted);
        }

        .progress-bar{
            height:10px;
            background:#eef3fb;
            border-radius:999px;
            overflow:hidden;
            margin-bottom:6px;
        }
        .progress{
            height:100%;
            width:0%;
            background:linear-gradient(90deg,var(--accent),#3aa0ff);
            transition:width .25s ease;
        }

        .toast{
            position:fixed;
            right:20px;
            bottom:20px;
            background:#fff;
            border-radius:8px;
            padding:12px 14px;
            box-shadow:0 8px 30px rgba(12,20,40,0.08);
            display:flex;
            gap:10px;
            align-items:center;
            min-width:220px;
            z-index:9999;
            border-left:6px solid var(--accent);
        }
        .toast.success{border-left-color:var(--success)}
        .toast.error{border-left-color:var(--error)}
        .toast .msg{font-size:14px;color:#071127}

        @media (max-width:760px){
            .grid-2{grid-template-columns:1fr}
            .actions{justify-content:stretch;flex-direction:column-reverse}
        }

        /* accessibility focus */
        input:focus, select:focus, textarea:focus, button:focus{
            box-shadow:0 0 0 4px rgba(11,116,222,0.12);
        }
    </style>
</head>
<body>
    <main class="container" aria-labelledby="title">
        <section class="card" role="region" aria-labelledby="title">
            <h1 id="title">Complete your student profile</h1>
            <p class="lead">Tell us about yourself. The more complete your profile, the better guidance and course suggestions we can offer.</p>

            <div class="progress-bar" aria-hidden="true">
                <div id="progress" class="progress" style="width:0%"></div>
            </div>

            <form id="profileForm" novalidate>
                <!-- Personal -->
                <div>
                    <div class="section-title">Personal details</div>
                    <div class="grid-2">
                        <div class="field">
                            <label for="fullName">Full name <span aria-hidden="true">*</span></label>
                            <input id="fullName" name="fullName" type="text" placeholder="Sujan Das" required />
                            <div class="hint">Enter your full legal or preferred name.</div>
                        </div>

                        <div class="field">
                            <label for="dob">Date of birth <span aria-hidden="true">*</span></label>
                            <input id="dob" name="dob" type="date" required />
                        </div>
                    </div>

                    <div class="grid-2" style="margin-top:6px">
                        <div class="field">
                            <label for="gender">Gender</label>
                            <select id="gender" name="gender" aria-describedby="genderHint">
                                <option value="">Prefer not to say</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                            <div id="genderHint" class="hint">Optional.</div>
                        </div>

                        <div class="field">
                            <label for="familyCount">Family members (count)</label>
                            <input id="familyCount" name="familyCount" type="number" min="1" max="20" placeholder="e.g., 5" />
                        </div>
                    </div>
                </div>

                <!-- Contact -->
                <div>
                    <div class="section-title">Contact & access</div>
                    <div class="grid-2">
                        <div class="field">
                            <label for="email">Email address <span aria-hidden="true">*</span></label>
                            <input id="email" name="email" type="email" placeholder="you@example.com" required />
                        </div>

                        <div class="field">
                            <label for="phone">Phone number</label>
                            <input id="phone" name="phone" type="tel" inputmode="tel" placeholder="+91 98765 43210" pattern="^\+?\d[\d\s-]{6,}$" />
                            <div class="hint">Include country code if possible.</div>
                        </div>
                    </div>

                    <div class="field" style="margin-top:6px">
                        <label for="address">Address</label>
                        <input id="address" name="address" type="text" placeholder="City, State, Country" />
                    </div>

                    <div class="grid-2" style="margin-top:6px">
                        <div class="field">
                            <label for="hasComputer">Do you have access to a computer?</label>
                            <select id="hasComputer" name="hasComputer">
                                <option value="">Select</option>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                        <div class="field">
                            <label for="hasSmartphone">Do you have access to a smartphone?</label>
                            <select id="hasSmartphone" name="hasSmartphone">
                                <option value="">Select</option>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Education -->
                <div>
                    <div class="section-title">Education</div>

                    <div class="grid-2">
                        <div class="field">
                            <label for="highSchool">Highest completed / current level</label>
                            <select id="highSchool" name="highSchool" required>
                                <option value="">Select</option>
                                <option value="class10">Class 10</option>
                                <option value="class12">Class 12 / HS</option>
                                <option value="diploma">Diploma</option>
                                <option value="bsc">Undergraduate (B.Sc / B.A / B.Com)</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="field">
                            <label for="stream">Stream / subjects</label>
                            <input id="stream" name="stream" type="text" placeholder="Physics, Chemistry, Mathematics" />
                        </div>
                    </div>

                    <div class="grid-2" style="margin-top:6px">
                        <div class="field">
                            <label for="marks">Recent exam marks / GPA</label>
                            <input id="marks" name="marks" type="text" placeholder="e.g., 376 / 500 or 7.8 GPA" />
                        </div>

                        <div class="field">
                            <label for="gradYear">Year completed / expected</label>
                            <input id="gradYear" name="gradYear" type="number" min="1900" max="2100" placeholder="2025" />
                        </div>
                    </div>
                </div>

                <!-- Preferences & career -->
                <div>
                    <div class="section-title">Goals & skills</div>

                    <div class="grid-2">
                        <div class="field">
                            <label for="careerGoals">Top career goals</label>
                            <select id="careerGoals" name="careerGoals" multiple aria-describedby="careerHint">
                                <option value="data_scientist">Data Scientist</option>
                                <option value="app_developer">App Developer</option>
                                <option value="web_developer">Web Developer</option>
                                <option value="teaching">Teaching</option>
                                <option value="research">Research</option>
                                <option value="other">Other</option>
                            </select>
                            <div id="careerHint" class="hint">Hold Ctrl (or Command) to select multiple options.</div>
                        </div>

                        <div class="field">
                            <label for="skills">Key skills / tools</label>
                            <input id="skills" name="skills" type="text" placeholder="Python, JavaScript, MATLAB, Statistics" />
                        </div>
                    </div>

                    <div class="field" style="margin-top:6px">
                        <label for="bio">Short bio (why you're studying / what you enjoy)</label>
                        <textarea id="bio" name="bio" placeholder="Write 2-4 sentences about your interests..."></textarea>
                        <div class="hint">Example: "I enjoy mathematics and coding. I want to become a data scientist." </div>
                    </div>
                </div>

                <!-- Upload photo -->
                <div>
                    <div class="section-title">Profile photo (optional)</div>
                    <div class="row photo-drop" role="group" aria-label="Profile photo upload">
                        <div class="photo-preview" id="photoPreview" aria-hidden="true">
                            <span class="small">No photo</span>
                        </div>
                        <div style="flex:1">
                            <input id="photoInput" name="photo" type="file" accept="image/*" />
                            <div class="hint">Upload a square-ish photo. Max 4MB recommended.</div>
                        </div>
                    </div>
                </div>

                <!-- Consent -->
                <div>
                    <label class="row" style="align-items:center">
                        <input id="consent" name="consent" type="checkbox" required />
                        <span style="margin-left:8px" class="small">I confirm the information is accurate.</span>
                    </label>
                </div>

                <div class="actions">
                    <button type="button" class="btn btn-muted" id="saveDraft">Save draft</button>
                    <button type="submit" class="btn" id="submitBtn">Submit profile</button>
                </div>
            </form>
        </section>

        <section class="card">
            <div class="section-title">Tips</div>
            <ul class="small" style="margin:8px 0 0 18px">
                <li>Required fields are validated in the browser.</li>
                <li>Use accurate contact info so we can reach you for guidance.</li>
                <li>You can save a draft locally before final submit.</li>
            </ul>
        </section>
    </main>

    <!-- Toast container injected by JS when needed -->
    <script>
        // Simple toast system
        function showToast(message, type = "success", duration = 3500) {
            const t = document.createElement("div");
            t.className = "toast " + (type === "error" ? "error" : "success");
            t.innerHTML = '<div class="msg"></div>';
            t.querySelector(".msg").textContent = message;
            document.body.appendChild(t);

            setTimeout(() => t.style.opacity = "1", 10);
            setTimeout(() => {
                t.style.transition = "opacity .3s ease, transform .3s ease";
                t.style.opacity = "0";
                t.style.transform = "translateY(12px)";
            }, duration);
            setTimeout(() => t.remove(), duration + 400);
        }

        // Photo preview
        const photoInput = document.getElementById("photoInput");
        const photoPreview = document.getElementById("photoPreview");

        photoInput.addEventListener("change", (e) => {
            const f = e.target.files && e.target.files[0];
            if (!f) {
                photoPreview.innerHTML = "<span class='small'>No photo</span>";
                return;
            }
            if (!f.type.startsWith("image/")) {
                showToast("Please upload an image file.", "error");
                photoInput.value = "";
                return;
            }
            if (f.size > 5 * 1024 * 1024) { // 5MB safety
                showToast("File too large. Choose under 5MB.", "error");
                photoInput.value = "";
                return;
            }
            const url = URL.createObjectURL(f);
            photoPreview.innerHTML = "<img alt='Profile preview' src='" + url + "' />";
        });

        // Progress calculation (very simple: percent of required fields filled)
        const form = document.getElementById("profileForm");
        const progressBar = document.getElementById("progress");
        const requiredSelectors = ["#fullName", "#dob", "#email", "#highSchool", "#consent"];

        function updateProgress() {
            let filled = 0;
            requiredSelectors.forEach(sel => {
                const el = document.querySelector(sel);
                if (!el) return;
                if (el.type === "checkbox") {
                    if (el.checked) filled++;
                } else if (el.value && el.value.trim() !== "") {
                    filled++;
                }
            });
            const pct = Math.round((filled / requiredSelectors.length) * 100);
            progressBar.style.width = pct + "%";
        }

        // Save draft to localStorage
        document.getElementById("saveDraft").addEventListener("click", () => {
            const data = new FormData(form);
            const obj = {};
            for (const [k, v] of data.entries()) {
                // file intentionally skipped in draft
                if (k === "photo") continue;
                obj[k] = v;
            }
            localStorage.setItem("studentProfileDraft", JSON.stringify(obj));
            showToast("Draft saved locally.");
        });

        // Load draft if exists
        window.addEventListener("load", () => {
            const raw = localStorage.getItem("studentProfileDraft");
            if (!raw) return;
            try {
                const obj = JSON.parse(raw);
                for (const k in obj) {
                    const el = form.elements[k];
                    if (!el) continue;
                    if (el.type === "checkbox") el.checked = obj[k] === "on" || obj[k] === true;
                    else el.value = obj[k];
                }
                updateProgress();
                showToast("Draft loaded from local storage.", "success", 2200);
            } catch (err) {
                console.warn("Could not load draft", err);
            }
        });
        
        // Basic validation + submit handler
        form.addEventListener("input", updateProgress);

        form.addEventListener("submit", (ev) => {
            ev.preventDefault();
            // browser built-in validity check
            if (!form.checkValidity()) {
                // find first invalid
                const firstInvalid = form.querySelector(":invalid");
                firstInvalid?.focus();
                showToast("Please fill required fields correctly.", "error");
                return;
            }

            // Get form data
            const data = new FormData(form);

            // Convert multiple-select careerGoals into array
            const careerEl = form.elements["careerGoals"];
            if (careerEl && careerEl.options) {
                const selected = [];
                for (const opt of careerEl.options) {
                    if (opt.selected) selected.push(opt.value);
                }
                data.delete("careerGoals");
                selected.forEach(v => data.append("careerGoals[]", v));
            }

            // Prepare payload (example)
            const payload = {};
            data.forEach((v, k) => {
                // handle multiple keys with [] suffix
                if (k.endsWith("[]")) {
                    const base = k.slice(0, -2);
                    payload[base] = payload[base] || [];
                    payload[base].push(v);
                } else {
                    payload[k] = v;
                }
            });

            // Optional: Attachment handling
            const file = form.elements["photo"]?.files?.[0];
            if (file) {
                // For demo we don't upload; in production create FormData and send to server.
                payload._photoName = file.name;
            }

            // Simulate save
            try {
                // Replace below with an actual fetch POST to your server.
                // fetch('/api/saveProfile', { method:'POST', body: formData })
                console.log("Profile payload:", payload);
                showToast("Profile submitted successfully.");
                // clear draft after submit
                localStorage.removeItem("studentProfileDraft");
            } catch (err) {
                console.error(err);
                showToast("Could not submit profile. Try again.", "error");
            }
        });

        // Initial progress run
        updateProgress();
    </script>
</body>
</html>